<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Packet Capture &#8211; Spencer Drayton</title>
	<atom:link href="./index.html" rel="self" type="application/rss+xml" />
	<link>./../../../index.html</link>
	<description>Information Security, Software Engineering</description>
	<lastBuildDate>Sat, 18 Sep 2021 17:11:38 +0000</lastBuildDate>
	<language>en-GB</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	
	<item>
		<title>Cloud Hosted Honeypots: Harvesting Attack Packet Captures</title>
		<link>./../../../cloud-hosted-honeypots-harvesting-attack-packet-captures/index.html</link>
		
		<dc:creator><![CDATA[spen440]]></dc:creator>
		<pubDate>Wed, 23 Aug 2017 14:59:37 +0000</pubDate>
				<category><![CDATA[Honeypot]]></category>
		<category><![CDATA[Threat Intelligence]]></category>
		<category><![CDATA[MHN]]></category>
		<category><![CDATA[Packet Capture]]></category>
		<category><![CDATA[Wireshark]]></category>
		<guid isPermaLink="false">./../../../index.html?p=321</guid>

					<description><![CDATA[&#160; Introduction Packet and protocol analysis are skills which fall squarely into the &#8220;use it or lose it&#8221; category, and can easily atrophy through lack of practice. As Stephen Northcutt &#8211; President of the SANS Technology Institute &#8211; says in the foreword to Brian Caswell, Jay Beale and Andrew Baker&#8217;s book Snort Intrusion Detection and Prevention [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>&nbsp;</p>
<h2>Introduction</h2>
<p>Packet and protocol analysis are skills which fall squarely into the &#8220;use it or lose it&#8221; category, and can easily atrophy through lack of practice. As Stephen Northcutt &#8211; President of the SANS Technology Institute &#8211; says in the foreword to Brian Caswell, Jay Beale and Andrew Baker&#8217;s book <a href="https://www.elsevier.com/books/snort-intrusion-detection-and-prevention-toolkit/caswell/978-1-59749-099-3?start_rank=1&amp;sortby=sortByRelevance&amp;imprintname=Syngress&amp;q=snort">Snort Intrusion Detection and Prevention Toolkit</a>: &#8220;<em>&#8230;understanding the network traffic entering, leaving and within your network</em>&#8230;&#8221; is one of the &#8220;&#8230;<em>basic skills a professional must have to avoid being impotent as a security practitioner</em>&#8220;.</p>
<p>There are plenty of publicly available sources of sample packet captures on the internet, but <span id="more-321"></span>personally I&#8217;d prefer to capture my own. Having detailed knowledge of (and control over) the environment in which the capture was generated not only allows for much more comprehensive analysis of the traffic itself to be performed, but also allows for inspection of the state of the local devices involved in the network conversations, which can give more insight into the outcome of the communcation events, and possibly the intentions of the actors responsible for initiating the exchange.</p>
<h2>Modern Honey Network</h2>
<p>Setting up a honeypot seemed to be a good way of going about attracting the attention of malicious actors and recording any interactions which take place, so I decided to pursue this as a coure of action. I&#8217;d recently read an article about <a href="https://www.anomali.com/platform/modern-honey-net">Modern Honey Network</a> and it sounded like this might be an ideal means of acheiving my objective. MHN is a framework for deploying and monitoring a network of distributed, low-interaction honeypots. It&#8217;s an open source project developed by the engineers responsible for the <a href="https://www.anomali.com/platform/threatstream">ThreatStream</a> Threat Intelligence Platform. It supports the <a href="https://github.com/rep/hpfeeds">HPFeeds</a> authenticated publish-subscribe protocol, to allow it to receive threat event data from deployed honeypots.</p>
<p>MHN supports a large number of honeypot implementations, including <a href="https://github.com/DinoTools/dionaea">Dionaea</a> which I decided to try out first as a means of testing the deployment process.</p>
<p><strong>Note:</strong> The primary purpose of the framework described here is the collection of malware samples for analysis;  I plan to document the results of experimenting with these capabilities in a later post.</p>
<h2>Infrastructure</h2>
<p>To avoid the security issues associated with hosting a honeypot on my own DMZ and exposing it to the outside world, I decided to make use of Amazon&#8217;s <a href="https://aws.amazon.com/free/">AWS EC2 free tier</a> and set up separate <a href="https://aws.amazon.com/ec2/instance-types/t2/">t2 micro</a> instances for MHN and the Dionaea honeypot sensor node:</p>
<figure id="attachment_323" aria-describedby="caption-attachment-323" style="width: 980px" class="wp-caption aligncenter"><a href="./../../../wp-content/uploads/2017/08/4D5AF066-AAA3-43E1-904B-5CC1BF9C77FE.jpg"><img fetchpriority="high" decoding="async" class="wp-image-323 size-large" src="./../../../wp-content/uploads/2017/08/4D5AF066-AAA3-43E1-904B-5CC1BF9C77FE-1024x327.jpg" alt="" width="980" height="313" data-wp-pid="323" srcset="./../../../wp-content/uploads/2017/08/4D5AF066-AAA3-43E1-904B-5CC1BF9C77FE-1024x327.jpg 1024w, ./../../../wp-content/uploads/2017/08/4D5AF066-AAA3-43E1-904B-5CC1BF9C77FE-300x96.jpg 300w, ./../../../wp-content/uploads/2017/08/4D5AF066-AAA3-43E1-904B-5CC1BF9C77FE-768x245.jpg 768w, ./../../../wp-content/uploads/2017/08/4D5AF066-AAA3-43E1-904B-5CC1BF9C77FE-1536x490.jpg 1536w, ./../../../wp-content/uploads/2017/08/4D5AF066-AAA3-43E1-904B-5CC1BF9C77FE-210x67.jpg 210w, ./../../../wp-content/uploads/2017/08/4D5AF066-AAA3-43E1-904B-5CC1BF9C77FE.jpg 1840w" sizes="(max-width: 980px) 100vw, 980px" /></a><figcaption id="caption-attachment-323" class="wp-caption-text">AWS EC2 t2 micro instances for the honeynet management and honeypot hosts.</figcaption></figure>
<h2>MHN Instance</h2>
<p>After setting up the MHN instance, I perfomed some rudimentary hardening &#8211; setting up an access control list within the AWS launch configuration to only permit traffic between my home machine and the MHN instance, and between the MHN instance and the honeypot instance, and also disabled all unneeded services. <strong>Note:</strong> <em>AWS EC2 instances by default release their public IP addresses when stopped. It&#8217;s worth allocating an Elastic IP address to the instance, to avoid having to reconfigure MHN and the underlying Nginx web server every time the instance is restarted.</em></p>
<p>Installing MHN involves spinning up the relevant EC2 instance, SSH&#8217;ing in and running through the installation steps detailed on the <a href="https://github.com/threatstream/mhn#installing-server-tested-ubuntu-12043-x86_64">MHN GitHub wiki page</a>. After the installation completes, the supervisorctl service can be queried to determine the state of the child services:</p>
<figure id="attachment_326" aria-describedby="caption-attachment-326" style="width: 661px" class="wp-caption aligncenter"><a href="./../../../wp-content/uploads/2017/08/538AAC4A-7B3D-4CC7-8644-13A4C71962C8.jpg"><img decoding="async" class="wp-image-326" src="./../../../wp-content/uploads/2017/08/538AAC4A-7B3D-4CC7-8644-13A4C71962C8.jpg" alt="" width="661" height="263" data-wp-pid="326" srcset="./../../../wp-content/uploads/2017/08/538AAC4A-7B3D-4CC7-8644-13A4C71962C8.jpg 603w, ./../../../wp-content/uploads/2017/08/538AAC4A-7B3D-4CC7-8644-13A4C71962C8-300x119.jpg 300w, ./../../../wp-content/uploads/2017/08/538AAC4A-7B3D-4CC7-8644-13A4C71962C8-210x84.jpg 210w" sizes="(max-width: 661px) 100vw, 661px" /></a><figcaption id="caption-attachment-326" class="wp-caption-text">MHN service status</figcaption></figure>
<p>Opening a web browser at the IP address of the MHN instance should cause the MHN web server landing page to be displayed, confirming a successful installation.</p>
<h2>Honeypot Instance</h2>
<p>The access control list of the AWS launch configuration associated with the honeypot instance needs to be updated allow attackers to interact with the fake vulnerable services presented by Dionaea. The services and protocols we&#8217;re particularly intested in here are: FTP, SMB, MSSQL and SIP, but we also need to allow access via SSH so we can communicate directly with the host for management purposes.</p>
<p>The next step is to launch the honeypot AWS EC2 instance and SSH into it. The honeypot deployment script can be accessed via the &#8220;Deploy&#8221; tab on the MHN web interface:</p>
<p><a href="./../../../wp-content/uploads/2017/08/08BE5F7B-31A1-4E06-BD90-EE7E838E2BF9.jpg"><img decoding="async" class="alignnone size-large wp-image-342" src="./../../../wp-content/uploads/2017/08/08BE5F7B-31A1-4E06-BD90-EE7E838E2BF9-1024x616.jpg" alt="" width="980" height="590" data-wp-pid="342" srcset="./../../../wp-content/uploads/2017/08/08BE5F7B-31A1-4E06-BD90-EE7E838E2BF9-1024x616.jpg 1024w, ./../../../wp-content/uploads/2017/08/08BE5F7B-31A1-4E06-BD90-EE7E838E2BF9-300x180.jpg 300w, ./../../../wp-content/uploads/2017/08/08BE5F7B-31A1-4E06-BD90-EE7E838E2BF9-768x462.jpg 768w, ./../../../wp-content/uploads/2017/08/08BE5F7B-31A1-4E06-BD90-EE7E838E2BF9-1536x923.jpg 1536w, ./../../../wp-content/uploads/2017/08/08BE5F7B-31A1-4E06-BD90-EE7E838E2BF9-210x126.jpg 210w, ./../../../wp-content/uploads/2017/08/08BE5F7B-31A1-4E06-BD90-EE7E838E2BF9.jpg 1592w" sizes="(max-width: 980px) 100vw, 980px" /></a></p>
<p>The script can be copied to the terminal connected to the honeypot instance and executed, causing the installation process to begin. Once complete, the supervisorctl service can be queried to determine the state of the child services:</p>
<figure id="attachment_343" aria-describedby="caption-attachment-343" style="width: 658px" class="wp-caption aligncenter"><a href="./../../../wp-content/uploads/2017/08/75F4B144-3FAC-4666-94DF-59B8662F7BF5.jpg"><img loading="lazy" decoding="async" class="wp-image-343" src="./../../../wp-content/uploads/2017/08/75F4B144-3FAC-4666-94DF-59B8662F7BF5.jpg" alt="" width="658" height="142" data-wp-pid="343" srcset="./../../../wp-content/uploads/2017/08/75F4B144-3FAC-4666-94DF-59B8662F7BF5.jpg 598w, ./../../../wp-content/uploads/2017/08/75F4B144-3FAC-4666-94DF-59B8662F7BF5-300x65.jpg 300w, ./../../../wp-content/uploads/2017/08/75F4B144-3FAC-4666-94DF-59B8662F7BF5-210x45.jpg 210w" sizes="(max-width: 658px) 100vw, 658px" /></a><figcaption id="caption-attachment-343" class="wp-caption-text">Dionaea honeypot service running</figcaption></figure>
<p>A OS and version Nmap scan directed at the IP address of the honeypot confirms that the ports for services we&#8217;re exposing are open (note also those marked as &#8216;closed&#8217; by nmap &#8211; these are ports open on the firewall but with no service behind them; this will be addressed at a later date when the relevant web, mail, directory and file services are enabled using installations of other honeypots on the same host).</p>
<figure id="attachment_325" aria-describedby="caption-attachment-325" style="width: 980px" class="wp-caption aligncenter"><a href="./../../../wp-content/uploads/2017/08/245FCA82-1000-4F25-B2BA-745CE2E5F874.jpg"><img loading="lazy" decoding="async" class="wp-image-325 size-large" src="./../../../wp-content/uploads/2017/08/245FCA82-1000-4F25-B2BA-745CE2E5F874-1024x796.jpg" alt="" width="980" height="762" data-wp-pid="325" srcset="./../../../wp-content/uploads/2017/08/245FCA82-1000-4F25-B2BA-745CE2E5F874-1024x796.jpg 1024w, ./../../../wp-content/uploads/2017/08/245FCA82-1000-4F25-B2BA-745CE2E5F874-300x233.jpg 300w, ./../../../wp-content/uploads/2017/08/245FCA82-1000-4F25-B2BA-745CE2E5F874-768x597.jpg 768w, ./../../../wp-content/uploads/2017/08/245FCA82-1000-4F25-B2BA-745CE2E5F874-210x163.jpg 210w, ./../../../wp-content/uploads/2017/08/245FCA82-1000-4F25-B2BA-745CE2E5F874.jpg 1294w" sizes="(max-width: 980px) 100vw, 980px" /></a><figcaption id="caption-attachment-325" class="wp-caption-text">Nmap scan of the honeypot host</figcaption></figure>
<p>With the honeypot up and running, it&#8217;s not long before attacks are being detected and communicated back the MHN management interface:</p>
<p><a href="./../../../wp-content/uploads/2017/08/F0D0D9C9-0741-4979-A6B6-F692B1E8EE33.jpg"><img loading="lazy" decoding="async" class="size-large wp-image-328 aligncenter" src="./../../../wp-content/uploads/2017/08/F0D0D9C9-0741-4979-A6B6-F692B1E8EE33-1024x554.jpg" alt="" width="980" height="530" data-wp-pid="328" srcset="./../../../wp-content/uploads/2017/08/F0D0D9C9-0741-4979-A6B6-F692B1E8EE33-1024x554.jpg 1024w, ./../../../wp-content/uploads/2017/08/F0D0D9C9-0741-4979-A6B6-F692B1E8EE33-300x162.jpg 300w, ./../../../wp-content/uploads/2017/08/F0D0D9C9-0741-4979-A6B6-F692B1E8EE33-768x416.jpg 768w, ./../../../wp-content/uploads/2017/08/F0D0D9C9-0741-4979-A6B6-F692B1E8EE33-1536x831.jpg 1536w, ./../../../wp-content/uploads/2017/08/F0D0D9C9-0741-4979-A6B6-F692B1E8EE33-210x114.jpg 210w, ./../../../wp-content/uploads/2017/08/F0D0D9C9-0741-4979-A6B6-F692B1E8EE33.jpg 1741w" sizes="(max-width: 980px) 100vw, 980px" /></a></p>
<p><a href="./../../../wp-content/uploads/2017/08/F7307E38-36C1-467A-B674-612203DDDBE5.jpg"><img loading="lazy" decoding="async" class="size-large wp-image-329 aligncenter" src="./../../../wp-content/uploads/2017/08/F7307E38-36C1-467A-B674-612203DDDBE5-1024x509.jpg" alt="" width="980" height="487" data-wp-pid="329" srcset="./../../../wp-content/uploads/2017/08/F7307E38-36C1-467A-B674-612203DDDBE5-1024x509.jpg 1024w, ./../../../wp-content/uploads/2017/08/F7307E38-36C1-467A-B674-612203DDDBE5-300x149.jpg 300w, ./../../../wp-content/uploads/2017/08/F7307E38-36C1-467A-B674-612203DDDBE5-768x381.jpg 768w, ./../../../wp-content/uploads/2017/08/F7307E38-36C1-467A-B674-612203DDDBE5-1536x763.jpg 1536w, ./../../../wp-content/uploads/2017/08/F7307E38-36C1-467A-B674-612203DDDBE5-210x104.jpg 210w, ./../../../wp-content/uploads/2017/08/F7307E38-36C1-467A-B674-612203DDDBE5.jpg 1907w" sizes="(max-width: 980px) 100vw, 980px" /></a></p>
<p><a href="./../../../wp-content/uploads/2017/08/honeymap-capture-001.png"><img loading="lazy" decoding="async" class="size-large wp-image-330 aligncenter" src="./../../../wp-content/uploads/2017/08/honeymap-capture-001-1024x515.png" alt="" width="980" height="493" data-wp-pid="330" srcset="./../../../wp-content/uploads/2017/08/honeymap-capture-001-1024x515.png 1024w, ./../../../wp-content/uploads/2017/08/honeymap-capture-001-300x151.png 300w, ./../../../wp-content/uploads/2017/08/honeymap-capture-001-768x386.png 768w, ./../../../wp-content/uploads/2017/08/honeymap-capture-001-1536x772.png 1536w, ./../../../wp-content/uploads/2017/08/honeymap-capture-001-210x106.png 210w, ./../../../wp-content/uploads/2017/08/honeymap-capture-001.png 1906w" sizes="(max-width: 980px) 100vw, 980px" /></a></p>
<h2>Packet Capture and Anlaysis</h2>
<p>Since</p>
<p>Since my initial objective was to capture network traffic at the honeypot whist it was under attack, I installed TShark (the command line version of the protocol analyser Wireshark) and began capturing packets:</p>
<figure id="attachment_324" aria-describedby="caption-attachment-324" style="width: 661px" class="wp-caption aligncenter"><a href="./../../../wp-content/uploads/2017/08/7F6C27DF-E565-4501-A10D-10C14B0DC05B.jpg"><img loading="lazy" decoding="async" class="wp-image-324" src="./../../../wp-content/uploads/2017/08/7F6C27DF-E565-4501-A10D-10C14B0DC05B.jpg" alt="" width="661" height="195" data-wp-pid="324" srcset="./../../../wp-content/uploads/2017/08/7F6C27DF-E565-4501-A10D-10C14B0DC05B.jpg 539w, ./../../../wp-content/uploads/2017/08/7F6C27DF-E565-4501-A10D-10C14B0DC05B-300x88.jpg 300w, ./../../../wp-content/uploads/2017/08/7F6C27DF-E565-4501-A10D-10C14B0DC05B-210x62.jpg 210w" sizes="(max-width: 661px) 100vw, 661px" /></a><figcaption id="caption-attachment-324" class="wp-caption-text">Capturing packet at the honeypot using TShark</figcaption></figure>
<p>After allowing TShark to run for about 15 minutes, I used SCP to copy the resultant pcap file back to my home machine for analysis in Wireshark. By comparing the threat event data presented on the MHN management interface with the traffic recorded within the pcap file, it was possible to identify what at first glance appear to be fairly typical attacks directed at specific services. For example, the screenshot below shows what appears to be a VoIP Caller ID spoof attack, where the &#8220;From&#8221; value embedded within the packet header has been falsified within a SIP protocol &#8220;INVITE&#8221; request:</p>
<p><a href="./../../../wp-content/uploads/2017/08/B47C1E42-05E7-4286-9671-8852812E3583.png"><img loading="lazy" decoding="async" class="size-large wp-image-327 aligncenter" src="./../../../wp-content/uploads/2017/08/B47C1E42-05E7-4286-9671-8852812E3583.png" alt="" width="974" height="879" data-wp-pid="327" srcset="./../../../wp-content/uploads/2017/08/B47C1E42-05E7-4286-9671-8852812E3583.png 974w, ./../../../wp-content/uploads/2017/08/B47C1E42-05E7-4286-9671-8852812E3583-300x271.png 300w, ./../../../wp-content/uploads/2017/08/B47C1E42-05E7-4286-9671-8852812E3583-768x693.png 768w, ./../../../wp-content/uploads/2017/08/B47C1E42-05E7-4286-9671-8852812E3583-210x190.png 210w" sizes="(max-width: 974px) 100vw, 974px" /></a>Pcap file captured from honeypot analysed in Wireshark</p>
<h2>Conclusion</h2>
<p>The Modern Honey Network project greatly simplifies the process of setting up and monitoring a network of low-interaction honeypots. This post described the outcome of my initial experiments using the platform as a means of capturing &#8216;real life&#8217; packet data for analysis. The next steps will involve improving the configuration of the exposed fake services to present a more attractive target to attackers, in the hope that threat activity of a more advanced, persistent nature might be captured. I also plan to expand the network detailed in this post with additional honeypots, and to make use of the framework&#8217;s in-built facilties for capturing samples of malware for analysis.</p>
]]></content:encoded>
					
		
		
			</item>
		<item>
		<title>Throwing Star LAN Tap</title>
		<link>./../../../throwing-star-lan-tap/index.html</link>
		
		<dc:creator><![CDATA[spen440]]></dc:creator>
		<pubDate>Wed, 02 Aug 2017 17:50:05 +0000</pubDate>
				<category><![CDATA[Network Reconnaissance]]></category>
		<category><![CDATA[Ethernet]]></category>
		<category><![CDATA[Network]]></category>
		<category><![CDATA[Packet Capture]]></category>
		<category><![CDATA[Wireshark]]></category>
		<guid isPermaLink="false">./../../../index.html?p=209</guid>

					<description><![CDATA[Just recently I decided to add a passive LAN tap to my toolkit, partly because I needed a quick, easy and non-intrusive way of being able to monitor network traffic, and partly to justify buying a new soldering iron. The kit was manufactured by Great Scott Gadgets to Michael Ossman&#8217;s original design and supplied by RoboSavvy. [&#8230;]]]></description>
										<content:encoded><![CDATA[<h2></h2>
<p>Just recently I decided to add a passive LAN tap to my toolkit, partly because I needed a quick, easy and non-intrusive way of being able to monitor network traffic, and partly to justify buying a new soldering iron.</p>
<p><span id="more-209"></span></p>
<p>The kit was manufactured by <a href="https://greatscottgadgets.com/">Great Scott Gadgets</a> to <a href="http://ossmann.blogspot.co.uk/2011/02/throwing-star-lan-tap.html">Michael Ossman&#8217;s</a> original design and supplied by <a href="https://robosavvy.com/web/">RoboSavvy</a>. It&#8217;s been a while since I tackled anything involving a PCB and molten metal, but the lack of dry and/or bridged joints must mean I haven&#8217;t completely lost the ability to solder just yet.</p>
<figure id="attachment_212" aria-describedby="caption-attachment-212" style="width: 376px" class="wp-caption aligncenter"><a href="./../../../wp-content/uploads/2017/08/t-star-lan-tap.jpeg"><img loading="lazy" decoding="async" class="wp-image-212" src="./../../../wp-content/uploads/2017/08/t-star-lan-tap-300x232.jpeg" alt="" width="376" height="291" data-wp-pid="212" srcset="./../../../wp-content/uploads/2017/08/t-star-lan-tap-300x232.jpeg 300w, ./../../../wp-content/uploads/2017/08/t-star-lan-tap-210x163.jpeg 210w, ./../../../wp-content/uploads/2017/08/t-star-lan-tap.jpeg 431w" sizes="(max-width: 376px) 100vw, 376px" /></a><figcaption id="caption-attachment-212" class="wp-caption-text">Kit contents</figcaption></figure>
<figure id="attachment_26" aria-describedby="caption-attachment-26" style="width: 376px" class="wp-caption aligncenter"><a href="./../../../wp-content/uploads/2017/05/WP_20170518_17_46_44_Pro-e1495127160427.jpg"><img loading="lazy" decoding="async" class="wp-image-26" src="./../../../wp-content/uploads/2017/05/WP_20170518_17_46_44_Pro-e1495127160427-240x300.jpg" alt="" width="376" height="470" data-wp-pid="26" srcset="./../../../wp-content/uploads/2017/05/WP_20170518_17_46_44_Pro-e1495127160427-240x300.jpg 240w, ./../../../wp-content/uploads/2017/05/WP_20170518_17_46_44_Pro-e1495127160427-820x1024.jpg 820w, ./../../../wp-content/uploads/2017/05/WP_20170518_17_46_44_Pro-e1495127160427-768x959.jpg 768w, ./../../../wp-content/uploads/2017/05/WP_20170518_17_46_44_Pro-e1495127160427-168x210.jpg 168w, ./../../../wp-content/uploads/2017/05/WP_20170518_17_46_44_Pro-e1495127160427.jpg 841w" sizes="(max-width: 376px) 100vw, 376px" /></a><figcaption id="caption-attachment-26" class="wp-caption-text">Fully assembled</figcaption></figure>
<p>There are four RJ-45 ports &#8211; two for connecting in-line on the Ethernet network to be monitored, and two monitoring ports. As an unpowered tap, it doesn&#8217;t have the ability to cope with full duplex Gigabit Ethernet, so only two of transmit/receive pairs are broken out to monitor ports. This also means that the monitoring ports are unidirectional; to sniff traffic in both directions at the same time you&#8217;d need to connect both monitoring ports, for example using a dual port NIC.</p>
<p>The on board capacitors are there to act as low-pass filters, forcing the network devices at either end of the network segment being monitored to fall back to 100BASE-T, allowing Gigabit traffic 1000BASE-T to at least be monitored, albeit over a link downgraded to Fast Ethernet (of course, if you only ever want to sniff 100BASE-T traffic, none of that matters anyway).</p>
<p>As a quick test just to prove things work as expected, I inserted the tap between my Mac and a switch on my home network, then kicked off an aggressive Nmap scan against my wife&#8217;s poor unsuspecting Roberts &#8220;smart&#8221; radio. Running Wireshark on a laptop connected to the upstream monitoring port, we can see the scan activity being directed at the target device; the capture in the screenshot shows an attempt by Nmap to locate signs of unprotected Git repositories at the root of the web admin interface, by using the http-gti.nse script as part of the aggressive scan:</p>
<p><a href="./../../../wp-content/uploads/2017/08/WP_20170801_17_20_39_Rich_LI-2.png"><img loading="lazy" decoding="async" class=" wp-image-278 aligncenter" src="./../../../wp-content/uploads/2017/08/WP_20170801_17_20_39_Rich_LI-2-169x300.png" alt="" width="231" height="410" srcset="./../../../wp-content/uploads/2017/08/WP_20170801_17_20_39_Rich_LI-2-169x300.png 169w, ./../../../wp-content/uploads/2017/08/WP_20170801_17_20_39_Rich_LI-2-118x210.png 118w, ./../../../wp-content/uploads/2017/08/WP_20170801_17_20_39_Rich_LI-2.png 577w" sizes="(max-width: 231px) 100vw, 231px" /></a></p>
<figure id="attachment_215" aria-describedby="caption-attachment-215" style="width: 660px" class="wp-caption aligncenter"><a href="./../../../wp-content/uploads/2017/08/lan-tap-nmap.png"><img loading="lazy" decoding="async" class="wp-image-215" src="./../../../wp-content/uploads/2017/08/lan-tap-nmap-300x150.png" alt="" width="660" height="330" data-wp-pid="215" srcset="./../../../wp-content/uploads/2017/08/lan-tap-nmap-300x150.png 300w, ./../../../wp-content/uploads/2017/08/lan-tap-nmap-768x384.png 768w, ./../../../wp-content/uploads/2017/08/lan-tap-nmap-210x105.png 210w, ./../../../wp-content/uploads/2017/08/lan-tap-nmap.png 818w" sizes="(max-width: 660px) 100vw, 660px" /></a><figcaption id="caption-attachment-215" class="wp-caption-text">Nmap scan</figcaption></figure>
<figure id="attachment_206" aria-describedby="caption-attachment-206" style="width: 661px" class="wp-caption aligncenter"><a href="./../../../wp-content/uploads/2017/08/lan-tap-cap.png"><img loading="lazy" decoding="async" class="wp-image-206" src="./../../../wp-content/uploads/2017/08/lan-tap-cap-300x169.png" alt="" width="661" height="372" data-wp-pid="206" srcset="./../../../wp-content/uploads/2017/08/lan-tap-cap-300x169.png 300w, ./../../../wp-content/uploads/2017/08/lan-tap-cap-1024x576.png 1024w, ./../../../wp-content/uploads/2017/08/lan-tap-cap-768x432.png 768w, ./../../../wp-content/uploads/2017/08/lan-tap-cap-210x118.png 210w, ./../../../wp-content/uploads/2017/08/lan-tap-cap.png 1366w" sizes="(max-width: 661px) 100vw, 661px" /></a><figcaption id="caption-attachment-206" class="wp-caption-text">Packet analysis with Wireshark</figcaption></figure>
<p>Given that it&#8217;s highly portable, easy to use and invisible to network scans, I suspect this little gadget will be getting plenty of use in the field in the near future.</p>
]]></content:encoded>
					
		
		
			</item>
	</channel>
</rss>
